<nz-page-header [nzTitle]="'BTC Address 一 ' + pipeline.address">
  <nz-page-header-extra>
    <button (click)="openInV1()" nz-button nzType="default" nzShape="circle"><i nz-icon type="experiment"></i></button>
  </nz-page-header-extra>
</nz-page-header>
<div nz-row>
  <div nz-col>
    <nz-breadcrumb style="margin: 16px;">
      <nz-breadcrumb-item>Address Scan</nz-breadcrumb-item>
      <nz-breadcrumb-item>Scan History</nz-breadcrumb-item>
      <nz-breadcrumb-item>Result 一 {{pipeline.address}}</nz-breadcrumb-item>
    </nz-breadcrumb>
  </div>
</div>



<div style="padding: 12px;">
  <nz-row [nzGutter]="16">
    <nz-col [nzSpan]="4">
      <nz-card>
        <nz-statistic [nzValue]="witnessSummary.critical" [nzTitle]="'Critical'"
          [nzValueStyle]="{ color: '#EB2F96' }">
        </nz-statistic>

      </nz-card>
    </nz-col>
    <nz-col [nzSpan]="4">
      <nz-card>
        <nz-statistic [nzValue]="witnessSummary.high" [nzTitle]="'High'"
          [nzValueStyle]="{ color: '#f5222d' }">
        </nz-statistic>

      </nz-card>
    </nz-col>

    <nz-col [nzSpan]="4">
      <nz-card>
        <nz-statistic [nzValue]="witnessSummary.medium" [nzTitle]="'Medium'"
          [nzValueStyle]="{ color: '#fa8c16' }">
        </nz-statistic>

      </nz-card>
    </nz-col>

    <nz-col [nzSpan]="4">
      <nz-card>
        <nz-statistic [nzValue]="witnessSummary.low" [nzTitle]="'Low'"
          [nzValueStyle]="{ color: '#2f54eb' }">
        </nz-statistic>
        <ng-template #prefixTplOne><i nz-icon type="arrow-up"></i></ng-template>
      </nz-card>
    </nz-col>
    <nz-col [nzSpan]="4">
      <nz-card>
        <nz-statistic [nzValue]="witnessSummary.normal" [nzTitle]="'Normal'"
          [nzValueStyle]="{ color: '#52c41a' }">
        </nz-statistic>

      </nz-card>
    </nz-col>

  </nz-row>
</div>

<nz-content style="margin:24px 16px 0;">
  <nz-spin [nzSpinning]="isLoadingPipeline">
    <div style="padding:24px; background: #fff; min-height: 550px;">
      <div nz-row>
        <div nz-col nzSpan="23">
          <nz-tabset [nzTabPosition]="'right'" [nzType]="'line'">
            <nz-tab [nzTitle]="'Issues'">
              <h2>Issues</h2>
              <nz-table #issueTable [nzLoading]="isWitnessLoading" [nzData]="witnessResultPage.records"
                nzShowSizeChanger [nzFrontPagination]="false" [(nzPageIndex)]="witnessPageNo"
                [(nzPageSize)]="witnessPageSize" [nzTotal]="witnessResultPage.totalRecords"
                (nzPageIndexChange)="reloadWitnessPage(false)"
                (nzPageSizeChange)="reloadWitnessPage(true)">
                <thead>
                  <tr>
                    <th>
                      Rule ID
                    </th>
                    <th style="width: 100px;">Risk Level</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>

                  <tr *ngFor="let data of issueTable.data">
                    <td>
                      <a href="#">{{ data.ruleId }}</a>
                    </td>
                    <td>
                      <nz-badge *ngIf="data.riskLevel === 5" nzColor="pink" nzText="Critical"></nz-badge>
                      <nz-badge *ngIf="data.riskLevel === 4" nzColor="red" nzText="High"></nz-badge>
                      <nz-badge *ngIf="data.riskLevel === 3" nzColor="orange" nzText="Medium"></nz-badge>
                      <nz-badge *ngIf="data.riskLevel === 2" nzColor="geekblue" nzText="Low"></nz-badge>
                      <nz-badge *ngIf="data.riskLevel === 1" nzColor="green" nzText="Normal"></nz-badge>
                    </td>

                    <td>
                      <code>{{data.description}}</code>
                    </td>


                  </tr>
                </tbody>
              </nz-table>
            </nz-tab>
            <nz-tab [nzTitle]="'Taint'">
              <h2>Taint Table</h2>
              <nz-table #basicTable [nzLoading]="isAddressTaintJobLoading" [nzData]="addressTaintJobResultPage.records"
                nzShowSizeChanger [nzFrontPagination]="false" [(nzPageIndex)]="addressTaintJobResultPageNo"
                [(nzPageSize)]="addressTaintJobResultPageSize" [nzTotal]="addressTaintJobResultPage.totalRecords"
                (nzPageIndexChange)="reloadAddressTaintJobResultPage(false)"
                (nzPageSizeChange)="reloadAddressTaintJobResultPage(true)">
                <thead>
                  <tr>
                    <th>
                      Address
                    </th>
                    <th>Total Amount</th>
                    <th>Max Score EV</th>
                  </tr>
                </thead>
                <tbody>

                  <tr *ngFor="let data of basicTable.data">
                    <td>
                      <i class="direction-icon" *ngIf="data.direction==='F'" nz-icon nzType="swap-right"
                        nzTheme="outline"></i>
                      {{ data.address }}
                      <i class="direction-icon" *ngIf="data.direction==='B'" nz-icon nzType="swap-right"
                        nzTheme="outline"></i>
                    </td>

                    <td>{{ data.totalAmount | crypto: 'satoshi' : 'btc'}} BTC</td>
                    <td>
                      <span>{{ data.maxScoreEv | number:'.1-3'}}</span>
                    </td>

                  </tr>
                </tbody>
              </nz-table>
            </nz-tab>
            <nz-tab [nzTitle]="'Flow'" (nzSelect)="flowTabSelected()">
              <nz-spin [nzSpinning]="isLoadingDiagram" nzTip="Loading...">
                <div nz-row>
                  <div nz-col nzSpan="24">
                    <h2>Flow Analysis</h2>
                  </div>
                </div>
                <div nz-row>
                  <div nz-col nzSpan="22" nzOffset="1" style="text-align: right;">
                    <button (click)="initDiagram()" nz-button nzType="primary" nzShape="round"><i nz-icon
                        nzType="reload" nzTheme="outline"></i>Reload</button>
                  </div>
                </div>
                <div nz-row>
                  <div nz-col nzSpan="22" nzOffset="1">
                    <nz-divider></nz-divider>
                  </div>
                </div>
                <div nz-row>
                  <div nz-col nzSpan="22" nzOffset="1">
                    <nz-slider [nzMarks]="dateRangeMarks" [nzMin]="0" [nzMax]="maxDays" [nzStep]="1" nzRange
                      [ngModel]="dateRange" [nzTipFormatter]="dateRangeTipFormatter"></nz-slider>
                  </div>
                </div>

                <div nz-row>
                  <div nz-col nzSpan="22" nzOffset="1">
                    <nz-divider></nz-divider>
                  </div>
                </div>

                <div nz-row>
                  <div nz-col nzSpan="24">
                    <div class="flow-diagram" #flowDiagramDiv></div>
                  </div>
                </div>
              </nz-spin>



            </nz-tab>
          </nz-tabset>
        </div>
      </div>

    </div>
  </nz-spin>

</nz-content>
